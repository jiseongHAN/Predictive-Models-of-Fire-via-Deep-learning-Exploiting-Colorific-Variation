import torch

def random_data_generator(size):
    data = torch.randint(0,256,(size, 3, 100, 100),dtype=torch.float)
    label = torch.randint(0,2,(size,1),dtype=torch.float)
    t_label = torch.cat((label, abs(label - 1)), -1)
    return data, t_label

def get_label(label_torch):
    label = torch.argmax(label_torch, -1)
    return label.tolist()


# 1-> 0
def compute_fp(pred_label,true_label):
    b = 0
    for i, j in zip(true_label, pred_label):
        if (i == 1 and j == 0):
            b += 1
    if true_label.count(1) == 0:
        return 0
    else:
        return b / true_label.count(1)

# 0->1
def compute_fn(pred_label,true_label):
    b = 0
    for i, j in zip(true_label, pred_label):
        if (i == 0 and j == 1):
            b += 1
    if true_label.count(0) == 0:
        return 0
    else:
        return b / true_label.count(0)

def accuracy(pred_label, true_label):
    b = 0
    for i, j in zip(true_label, pred_label):
        if (i == j):
            b += 1
    return b / len(pred_label)